<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CRM Follow Up</title>

<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --brand:#1c8c6e;
  --border:#dcdcdc;
  --bg:#f6fbf9;
  --icon-top:16px;
}
*{box-sizing:border-box}
body{
  font-family:"Prompt",sans-serif;
  background:var(--bg);
  margin:0;
  padding:16px;
  color:#333;
}

/* ===== Dashboard ===== */
.dashboard{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  gap:12px;
  margin-bottom:20px;
}
.card{
  background:#fff;
  padding:16px;
  border-radius:14px;
  text-align:center;
}
.card span{
  display:block;
  font-size:32px;
  font-weight:600;
}
.follow-green{background:#e6f7ee}
.follow-yellow{background:#fff8d6}
.follow-orange{background:#ffe3c2}
.follow-red{background:#ffd6d6}

/* ===== Form ===== */
.form-box{
  background:#fff;
  padding:20px;
  border-radius:18px;
  margin-bottom:22px;
}
.form-grid{
  display:grid;
  grid-template-columns:repeat(6,1fr);
  gap:14px;
}

/* ===== Input ===== */
.input-group{position:relative}
.input-group i{
  position:absolute;
  left:14px;
  top:var(--icon-top);
  font-size:15px;
  color:#9aa3a0;
}
.input-group input,
.input-group textarea{
  width:100%;
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px 14px 14px 42px;
  font-size:15px;
  font-family:"Prompt",sans-serif;
}
.input-group input{height:52px}
.input-group textarea{
  min-height:120px;
  resize:vertical;
}

/* ===== Button ===== */
button{
  width:100%;
  margin-top:18px;
  padding:14px;
  font-size:16px;
  border:none;
  border-radius:16px;
  background:var(--brand);
  color:#fff;
  cursor:pointer;
}

/* ===== Table ===== */
.table-box{
  background:#fff;
  border-radius:18px;
  overflow:hidden;
}
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:12px 10px;
  border-bottom:1px solid #eee;
  font-size:14px;
  vertical-align:top;
}
th{background:#f2f7f5}
.actions button{
  width:auto;
  padding:6px 10px;
  font-size:14px;
  border-radius:10px;
  margin-right:6px;
}
.actions .edit{background:#ffa726}
.actions .delete{background:#ef5350}

/* ===== Responsive ===== */
@media(max-width:1024px){
  .form-grid{grid-template-columns:repeat(3,1fr)}
}
@media(max-width:768px){
  .form-grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<h2>üìä CRM ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h2>

<div class="dashboard">
  <div class="card follow-green">üü¢ ‡∏õ‡∏Å‡∏ï‡∏¥<span id="dGreen">0</span></div>
  <div class="card follow-yellow">üü° ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°<span id="dYellow">0</span></div>
  <div class="card follow-orange">üü† ‡πÄ‡∏£‡πà‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°<span id="dOrange">0</span></div>
  <div class="card follow-red">üî¥ ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á<span id="dRed">0</span></div>
</div>

<div class="form-box">
<h3>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° /‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</h3>

<div class="form-grid">
  <div class="input-group">
    <input id="fDate" placeholder="DD/MM/YYYY" inputmode="numeric" maxlength="10" oninput="formatDate(this)">
    <i class="fa-solid fa-calendar-days"></i>
  </div>
  <div class="input-group">
    <input id="fName" placeholder="‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•">
    <i class="fa-solid fa-hospital"></i>
  </div>
  <div class="input-group">
    <input id="fContact" placeholder="‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠">
    <i class="fa-solid fa-user"></i>
  </div>
  <div class="input-group">
    <input id="fDepartment" placeholder="‡πÅ‡∏ú‡∏ô‡∏Å">
    <i class="fa-solid fa-sitemap"></i>
  </div>
  <div class="input-group">
    <input id="fProvince" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î">
    <i class="fa-solid fa-location-dot"></i>
  </div>
  <div class="input-group">
    <textarea id="fNote" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"></textarea>
    <i class="fa-solid fa-clipboard"></i>
  </div>
</div>

<button onclick="saveEntry()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
</div>

<div class="table-box">
<table>
<thead>
<tr>
  <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
  <th>‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</th>
  <th>‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</th>
  <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
  <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
  <th>‡∏ß‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏õ</th>
  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
  <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
  <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<script>
const STORAGE_KEY="crm_follow_entries";
let entries=JSON.parse(localStorage.getItem(STORAGE_KEY))||[];
let editIndex=null;

/* ===== Utils ===== */
function formatDate(i){
  let v=i.value.replace(/\D/g,'').slice(0,8);
  if(v.length>=5)i.value=v.replace(/(\d{2})(\d{2})(\d+)/,'$1/$2/$3');
  else if(v.length>=3)i.value=v.replace(/(\d{2})(\d+)/,'$1/$2');
  else i.value=v;
}
function parseDate(d){
  const [dd,mm,yy]=d.split('/');
  return new Date(`${yy}-${mm}-${dd}`);
}
function daysSince(d){
  return Math.floor((new Date()-parseDate(d))/86400000);
}
function followClass(x){
  return x<=7?"follow-green":x<=14?"follow-yellow":x<=21?"follow-orange":"follow-red";
}
function followText(x){
  return x<=7?"‡∏õ‡∏Å‡∏ï‡∏¥":x<=14?"‡∏Ñ‡∏ß‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°":x<=21?"‡πÄ‡∏£‡πà‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°":"‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á";
}

/* ===== Save / Edit ===== */
function saveEntry(){
  if(!fDate.value||!fName.value) return alert("‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö");
  const data={
    date:fDate.value,
    name:fName.value,
    contact:fContact.value,
    dept:fDepartment.value,
    province:fProvince.value,
    note:fNote.value
  };
  if(editIndex!==null){
    entries[editIndex]=data;
    editIndex=null;
  }else{
    entries.push(data);
  }
  localStorage.setItem(STORAGE_KEY,JSON.stringify(entries));
  clearForm();
  render();
}
function editEntry(i){
  const e=entries[i];
  fDate.value=e.date;
  fName.value=e.name;
  fContact.value=e.contact;
  fDepartment.value=e.dept;
  fProvince.value=e.province;
  fNote.value=e.note;
  editIndex=i;
  window.scrollTo({top:0,behavior:"smooth"});
}
function deleteEntry(i){
  if(!confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?"))return;
  entries.splice(i,1);
  localStorage.setItem(STORAGE_KEY,JSON.stringify(entries));
  render();
}
function clearForm(){
  fDate.value=fName.value=fContact.value=fDepartment.value=fProvince.value=fNote.value="";
}

/* ===== Render ===== */
function render(){
  tbody.innerHTML="";
  let g=0,y=0,o=0,r=0;
  entries.forEach((e,i)=>{
    const d=daysSince(e.date);
    const c=followClass(d);
    if(c==="follow-green")g++; else if(c==="follow-yellow")y++;
    else if(c==="follow-orange")o++; else r++;
    tbody.innerHTML+=`
      <tr class="${c}">
        <td>${e.date}</td>
        <td>${e.name}</td>
        <td>${e.contact}</td>
        <td>${e.dept}</td>
        <td>${e.province}</td>
        <td align="center">${d}</td>
        <td>${followText(d)}</td>
        <td>${e.note}</td>
        <td class="actions">
          <button class="edit" onclick="editEntry(${i})">‚úèÔ∏è</button>
          <button class="delete" onclick="deleteEntry(${i})">üóëÔ∏è</button>
        </td>
      </tr>`;
  });
  dGreen.textContent=g;
  dYellow.textContent=y;
  dOrange.textContent=o;
  dRed.textContent=r;
}
render();
</script>

</body>
</html>
